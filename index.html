<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Scroll PNG Sequence Over Video</title>

<style>
  /* Hide scrollbars and make body transparent */
  html, body {
    margin: 0;
    padding: 0;
    height: 500vh; /* scroll length for animation */
    overflow: hidden; /* hides iframe scrollbar */
    background: black; /* fallback for non-transparent areas */
  }

  /* Background video styling */
  #background-video {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 0;
  }

  /* Canvas sits on top of video */
  canvas#sequence {
    position: fixed;
    top: 0;
    left: 0;
    z-index: 1;
    pointer-events: none; /* allows clicks through */
  }
</style>
</head>

<body>

<!-- Background video -->
<video autoplay muted loop playsinline preload="auto" id="background-video">
  <source src="yourvideo.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>

<!-- PNG sequence canvas -->
<canvas id="sequence"></canvas>

<script>
/* ===========================
   SETTINGS
=========================== */
const frameCount = 99; // ðŸ”¥ Change to your total number of PNG frames
const imagePath = index => `images/frame_${index.toString().padStart(5,'0')}.png`;

/* ===========================
   CANVAS SETUP
=========================== */
const canvas = document.getElementById("sequence");
const context = canvas.getContext("2d");

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

/* ===========================
   PRELOAD IMAGES
=========================== */
const images = [];
for (let i = 0; i < frameCount; i++) {
  const img = new Image();
  img.src = imagePath(i);
  images.push(img);
}

/* ===========================
   DRAW IMAGE (COVER MODE)
=========================== */
function drawImageCover(img) {
  const canvasRatio = canvas.width / canvas.height;
  const imgRatio = img.width / img.height;

  let drawWidth, drawHeight;

  if (canvasRatio > imgRatio) {
    drawWidth = canvas.width;
    drawHeight = canvas.width / imgRatio;
  } else {
    drawHeight = canvas.height;
    drawWidth = canvas.height * imgRatio;
  }

  const x = (canvas.width - drawWidth) / 2;
  const y = (canvas.height - drawHeight) / 2;

  context.clearRect(0, 0, canvas.width, canvas.height);
  context.drawImage(img, x, y, drawWidth, drawHeight);
}

/* ===========================
   SIMULATED SCROLL FOR IFRAME
=========================== */
let fakeScroll = 0;

function handleWheel(e) {
  e.preventDefault();
  const delta = e.deltaY;
  fakeScroll += delta;
  const maxScroll = window.innerHeight * 5; // matches your 500vh
  fakeScroll = Math.max(0, Math.min(fakeScroll, maxScroll));

  const scrollFraction = fakeScroll / maxScroll;
  const frameIndex = Math.min(frameCount - 1, Math.floor(scrollFraction * frameCount));
  drawImageCover(images[frameIndex]);
}

// Draw first frame immediately
images[0].onload = () => drawImageCover(images[0]);

// Update frames on scroll wheel
window.addEventListener('wheel', handleWheel, { passive: false });

/* Optional: support touch for mobile */
let touchStartY = null;
window.addEventListener('touchstart', e => {
  touchStartY = e.touches[0].clientY;
}, { passive: true });

window.addEventListener('touchmove', e => {
  if (touchStartY === null) return;
  const delta = touchStartY - e.touches[0].clientY;
  fakeScroll += delta;
  const maxScroll = window.innerHeight * 5;
  fakeScroll = Math.max(0, Math.min(fakeScroll, maxScroll));

  const scrollFraction = fakeScroll / maxScroll;
  const frameIndex = Math.min(frameCount - 1, Math.floor(scrollFraction * frameCount));
  drawImageCover(images[frameIndex]);

  touchStartY = e.touches[0].clientY;
  e.preventDefault();
}, { passive: false });
</script>

</body>
</html>
