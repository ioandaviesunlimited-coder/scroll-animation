<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scroll PNG Sequence Over Video</title>

<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: black;
  }

  #background-video {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 0;
  }

  canvas#sequence {
    position: fixed;
    top: 0;
    left: 0;
    z-index: 1;
    pointer-events: none;
  }
</style>
</head>

<body>

<video autoplay muted loop playsinline preload="auto" id="background-video">
  <source src="yourvideo.mp4" type="video/mp4">
</video>

<canvas id="sequence"></canvas>

<script>
/* ===========================
   DEVICE DETECTION
=========================== */
const isMobile = window.innerWidth <= 768;

/* ===========================
   SETTINGS
=========================== */
const frameCount = 84; // ðŸ”¥ 84 frames for BOTH desktop and mobile
const scrollMultiplier = isMobile ? 3 : 5;

const imagePath = index => {
  const folder = isMobile ? "images/mobile" : "images/desktop";
  return `${folder}/frame_${index.toString().padStart(5,'0')}.png`;
};

/* Set scroll height */
document.body.style.height = `${scrollMultiplier * 100}vh`;

/* Remove video on mobile for performance */
if (isMobile) {
  const video = document.getElementById("background-video");
  video.parentNode.removeChild(video);
}

/* ===========================
   CANVAS SETUP
=========================== */
const canvas = document.getElementById("sequence");
const context = canvas.getContext("2d");

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

/* ===========================
   PRELOAD IMAGES
=========================== */
const images = [];
for (let i = 0; i < frameCount; i++) {
  const img = new Image();
  img.src = imagePath(i);
  images.push(img);
}

/* ===========================
   DRAW IMAGE (COVER MODE)
=========================== */
function drawImageCover(img) {
  const canvasRatio = canvas.width / canvas.height;
  const imgRatio = img.width / img.height;

  let drawWidth, drawHeight;

  if (canvasRatio > imgRatio) {
    drawWidth = canvas.width;
    drawHeight = canvas.width / imgRatio;
  } else {
    drawHeight = canvas.height;
    drawWidth = canvas.height * imgRatio;
  }

  const x = (canvas.width - drawWidth) / 2;
  const y = (canvas.height - drawHeight) / 2;

  context.clearRect(0, 0, canvas.width, canvas.height);
  context.drawImage(img, x, y, drawWidth, drawHeight);
}

/* ===========================
   SCROLL LOGIC
=========================== */
let fakeScroll = 0;
let maxScroll = window.innerHeight * scrollMultiplier;

function updateFrame() {
  const scrollFraction = fakeScroll / maxScroll;
  const frameIndex = Math.min(
    frameCount - 1,
    Math.floor(scrollFraction * frameCount)
  );
  drawImageCover(images[frameIndex]);
}

function handleWheel(e) {
  e.preventDefault();
  fakeScroll += e.deltaY;
  fakeScroll = Math.max(0, Math.min(fakeScroll, maxScroll));
  updateFrame();
}

window.addEventListener("wheel", handleWheel, { passive: false });

/* ===========================
   TOUCH SUPPORT (MOBILE)
=========================== */
let touchStartY = null;

window.addEventListener("touchstart", e => {
  touchStartY = e.touches[0].clientY;
}, { passive: true });

window.addEventListener("touchmove", e => {
  if (touchStartY === null) return;

  const delta = touchStartY - e.touches[0].clientY;
  fakeScroll += delta;
  fakeScroll = Math.max(0, Math.min(fakeScroll, maxScroll));

  updateFrame();

  touchStartY = e.touches[0].clientY;
  e.preventDefault();
}, { passive: false });

/* ===========================
   INITIAL FRAME
=========================== */
images[0].onload = () => drawImageCover(images[0]);

</script>

</body>
</html>
